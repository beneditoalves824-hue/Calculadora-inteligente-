
<div class="bg-secondary-800 rounded-xl shadow-lg border border-secondary-700 flex flex-col h-[75vh] max-w-4xl mx-auto">
  <div class="p-4 border-b border-secondary-700">
    <h2 class="font-poppins text-xl font-bold text-slate-100 text-center">Mentor IA - <span class="text-primary-400">Benedito</span></h2>
  </div>

  <div #chatContainer class="flex-1 p-6 overflow-y-auto space-y-6 bg-secondary-900">
    @for (message of messages(); track $index) {
      <div class="flex" [class.justify-end]="message.sender === 'user'" [class.justify-start]="message.sender === 'ai'">
        @if (message.sender === 'ai') {
          <div class="flex-shrink-0 mr-3">
            <div class="h-9 w-9 rounded-full bg-detail-500 text-white flex items-center justify-center font-bold font-poppins text-lg shadow-md">B</div>
          </div>
        }
        <div class="max-w-xl p-4 rounded-xl shadow-md"
             [class.bg-accent-600]="message.sender === 'user'"
             [class.text-white]="message.sender === 'user'"
             [class.rounded-br-none]="message.sender === 'user'"
             [class.bg-secondary-700]="message.sender === 'ai'"
             [class.text-slate-200]="message.sender === 'ai'"
             [class.rounded-bl-none]="message.sender === 'ai'">
          <p class="text-base leading-relaxed" [innerHTML]="message.text.replace(/\n/g, '<br>')"></p>
        </div>
      </div>
    }

    @if (isLoading()) {
      <div class="flex justify-start">
        <div class="flex-shrink-0 mr-3">
          <div class="h-9 w-9 rounded-full bg-detail-500 text-white flex items-center justify-center font-bold font-poppins text-lg shadow-md">B</div>
        </div>
        <div class="max-w-lg p-4 rounded-xl shadow-md bg-secondary-700 text-secondary-800 flex items-center space-x-2">
          <div class="w-2.5 h-2.5 bg-slate-400 rounded-full animate-pulse"></div>
          <div class="w-2.5 h-2.5 bg-slate-400 rounded-full animate-pulse [animation-delay:0.2s]"></div>
          <div class="w-2.5 h-2.5 bg-slate-400 rounded-full animate-pulse [animation-delay:0.4s]"></div>
        </div>
      </div>
    }
  </div>

  <div class="p-4 border-t border-secondary-700 bg-secondary-800">
    <form (ngSubmit)="sendMessage()" class="flex items-center space-x-3">
      <input type="text"
             [(ngModel)]="userInput"
             name="userInput"
             [disabled]="isLoading()"
             placeholder="Faça uma pergunta sobre gestão de banca..."
             class="flex-1 block w-full rounded-lg border-secondary-600 bg-secondary-700 text-slate-200 shadow-sm focus:border-accent-500 focus:ring-accent-500 sm:text-base p-3 disabled:bg-secondary-600/50">
      
      <button type="submit" 
              [disabled]="isLoading() || userInput().trim() === ''"
              class="inline-flex items-center justify-center rounded-full h-12 w-12 text-white bg-accent-600 hover:bg-accent-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-secondary-800 focus:ring-accent-500 disabled:bg-accent-500/40 disabled:cursor-not-allowed transition-all transform hover:scale-110">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5">
          <path d="M3.105 2.289a.75.75 0 00-.826.95l1.414 4.949a.75.75 0 00.95.54l3.11-1.162a.75.75 0 010 1.393L4.644 10.5l-1.414 4.95a.75.75 0 00.95.826l13.5-5.25a.75.75 0 000-1.442l-13.5-5.25z" />
        </svg>
      </button>
    </form>
  </div>
</div>
